<!DOCTYPE html>
<html lang="id" class="scroll-smooth dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OptimaBiz | Enterprise Navigator</title>
    
    <!-- Font & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
          --bg-main: #0B0813;
          --bg-sidebar: #14111D;
          --bg-card: #1A1625;
          --accent-purple: #9D5CFF;
          --accent-cyan: #00E5FF;
          --accent-emerald: #10B981;
          --text-primary: #FFFFFF;
          --text-secondary: #94A3B8;
          --border-light: rgba(255, 255, 255, 0.1);
        }

        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        body { 
          font-family: 'Plus Jakarta Sans', sans-serif; 
          -webkit-font-smoothing: antialiased;
          background-color: var(--bg-main);
          color: var(--text-primary);
          overflow-x: hidden;
          min-height: 100vh;
        }

        /* Hide Scrollbar */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Animations */
        @keyframes movingGradient {
          0% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
          100% { background-position: 0% 50%; }
        }

        @keyframes fadeInUp {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulseGlow {
          0%, 100% { box-shadow: 0 0 20px rgba(157, 92, 255, 0.3); }
          50% { box-shadow: 0 0 40px rgba(157, 92, 255, 0.6); }
        }

        .thinking-glow {
          position: relative;
          animation: pulseGlow 2s infinite;
        }

        .thinking-glow::after {
          content: '';
          position: absolute;
          top: -2px; left: -2px; right: -2px; bottom: -2px;
          background: linear-gradient(45deg, var(--accent-purple), var(--accent-cyan), var(--accent-purple));
          background-size: 200% 200%;
          z-index: -1;
          filter: blur(10px);
          animation: movingGradient 3s linear infinite;
          border-radius: inherit;
        }

        /* Glassmorphism Effect */
        .glass-panel {
          background: rgba(26, 22, 37, 0.9);
          backdrop-filter: blur(20px);
          border: 1px solid var(--border-light);
        }

        /* Button Styles */
        .btn-primary {
          background: linear-gradient(135deg, #9D5CFF 0%, #6D28D9 100%);
          color: white;
          border: none;
          font-weight: 800;
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .btn-primary:hover {
          transform: translateY(-2px);
          box-shadow: 0 10px 25px rgba(157, 92, 255, 0.4);
        }

        .btn-primary:active {
          transform: translateY(0);
        }

        .btn-cyan {
          background: linear-gradient(135deg, #00E5FF 0%, #00B4D8 100%);
          color: black;
          border: none;
          font-weight: 800;
          cursor: pointer;
        }

        .sidebar-item-active {
          background: linear-gradient(90deg, rgba(157, 92, 255, 0.2) 0%, rgba(157, 92, 255, 0) 100%);
          border-left: 4px solid var(--accent-purple);
        }

        /* Form Elements */
        input, select, textarea {
          background: #1A1625 !important;
          border: 1px solid rgba(255, 255, 255, 0.15) !important;
          color: white !important;
          transition: all 0.2s;
          appearance: none;
          border-radius: 16px;
          padding: 16px 20px;
          font-family: 'Plus Jakarta Sans', sans-serif;
          font-size: 14px;
          font-weight: 600;
          width: 100%;
        }

        select {
          background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='white' stroke-width='2'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19 9l-7 7-7-7' /%3E%3C/svg%3E");
          background-repeat: no-repeat;
          background-position: right 1rem center;
          background-size: 1rem;
          padding-right: 2.5rem;
        }

        input:focus, select:focus, textarea:focus {
          border-color: var(--accent-purple) !important;
          outline: none;
          box-shadow: 0 0 0 2px rgba(157, 92, 255, 0.2);
        }

        /* Stat Cards */
        .stat-card {
          padding: 32px;
          border-radius: 40px;
          border-left: 4px solid;
          animation: fadeInUp 0.6s ease-out;
        }

        .stat-card-content {
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          height: 100%;
        }

        .stat-label {
          font-size: 0.65rem;
          font-weight: 800;
          letter-spacing: 0.15em;
          text-transform: uppercase;
          color: var(--text-secondary);
          margin-bottom: 1rem;
        }

        .stat-value {
          font-size: 2.25rem;
          font-weight: 900;
          line-height: 1.1;
          margin-bottom: 0.5rem;
        }

        .stat-subtext {
          font-size: 0.75rem;
          font-weight: 700;
        }

        /* Utility Classes */
        .stagger-in {
          animation: fadeInUp 0.8s ease-out;
        }

        .stagger-in:nth-child(2) { animation-delay: 0.1s; }
        .stagger-in:nth-child(3) { animation-delay: 0.2s; }
        .stagger-in:nth-child(4) { animation-delay: 0.3s; }

        .line-clamp-1 {
          display: -webkit-box;
          -webkit-line-clamp: 1;
          -webkit-box-orient: vertical;
          overflow: hidden;
        }

        .line-clamp-2 {
          display: -webkit-box;
          -webkit-line-clamp: 2;
          -webkit-box-orient: vertical;
          overflow: hidden;
        }

        /* Layout */
        .container {
          width: 100%;
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 1.5rem;
        }

        /* Demo Indicator */
        .demo-indicator {
          transition: transform 0.3s ease;
        }

        .demo-indicator:hover {
          transform: scale(1.1);
        }

        /* Print Styles */
        @media print {
          .no-print { display: none !important; }
          body { background: white !important; color: black !important; overflow: visible !important; }
          .glass-panel { border: 1px solid #ddd !important; background: white !important; backdrop-filter: none !important; }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
          .stat-value {
            font-size: 1.75rem;
          }
          
          .stat-card {
            padding: 24px;
            border-radius: 32px;
          }
        }
    </style>
</head>
<body class="bg-[#0B0813] text-white selection:bg-purple-500/30">
    
    <!-- Main App Container -->
    <div id="app">
        <!-- Landing Page (Initial View) -->
        <div id="landing-page" class="h-screen bg-[#0B0813] overflow-y-auto hide-scrollbar flex flex-col items-center justify-center p-8">
            <div class="text-center stagger-in">
               <div class="inline-block px-5 py-2 rounded-full bg-purple-900/30 border border-purple-500/20 text-purple-400 text-[10px] font-black uppercase tracking-[0.2em] mb-12">üöÄ OPTIMABIZ ENTERPRISE</div>
               <h1 class="text-5xl md:text-7xl lg:text-8xl font-black mb-10 leading-[1.05] tracking-tight">Level Up Your <span class="text-[#9D5CFF]">Industry</span></h1>
               <p class="text-slate-400 text-lg md:text-xl lg:text-2xl mb-16 max-w-2xl mx-auto font-medium">Strategi pemasaran presisi untuk UMKM di segala sektor industri.</p>
               <button onclick="openConsole()" class="btn-primary px-12 py-6 rounded-2xl font-black text-sm uppercase tracking-widest shadow-2xl">Open Console</button>
            </div>
        </div>

        <!-- Main App (Hidden Initially) -->
        <div id="main-app" class="hidden flex h-screen bg-[#0B0813] overflow-hidden">
            <!-- Floating Demo Actions -->
            <div id="demo-actions" class="fixed top-32 right-8 z-[100] flex flex-col gap-4 no-print">
               <button title="Kuliner" onclick="loadDemoData('snack')" class="bg-orange-500/10 border border-orange-500/30 text-orange-400 p-4 rounded-full shadow-2xl demo-indicator">
                   <i data-lucide="cookie" class="w-6 h-6"></i>
               </button>
               <button title="Agribisnis" onclick="loadDemoData('agri')" class="bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 p-4 rounded-full shadow-2xl demo-indicator">
                   <i data-lucide="leaf" class="w-6 h-6"></i>
               </button>
               <button title="Edukasi" onclick="loadDemoData('edukasi')" class="bg-purple-500/10 border border-purple-500/30 text-purple-400 p-4 rounded-full shadow-2xl demo-indicator">
                   <i data-lucide="graduation-cap" class="w-6 h-6"></i>
               </button>
            </div>

            <!-- Sidebar (Desktop) -->
            <aside class="no-print hidden lg:flex w-80 h-full bg-[#14111D] flex-col p-10 border-r border-white/5 z-50">
                <div class="flex items-center gap-3 mb-16">
                    <div class="w-10 h-10 bg-purple-600 rounded-xl flex items-center justify-center text-xl shadow-lg">üöÄ</div>
                    <div>
                        <span class="font-extrabold text-xl tracking-tight block">OptimaBiz</span>
                        <span class="text-[10px] text-purple-400 font-bold uppercase tracking-widest">Navigator</span>
                    </div>
                </div>
                <nav class="flex-1 space-y-3">
                    <button onclick="changeView('dashboard')" class="sidebar-item w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold text-sm sidebar-item-active text-white">
                        <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                        <span>Dashboard</span>
                    </button>
                    <button onclick="changeView('inventory')" class="sidebar-item w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold text-sm text-slate-400 hover:bg-white/5 hover:text-white">
                        <i data-lucide="package" class="w-5 h-5"></i>
                        <span>Inventory</span>
                    </button>
                    <button onclick="changeView('strategy')" class="sidebar-item w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold text-sm text-slate-400 hover:bg-white/5 hover:text-white">
                        <i data-lucide="trending-up" class="w-5 h-5"></i>
                        <span>Strategy</span>
                    </button>
                    <button onclick="changeView('profile')" class="sidebar-item w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold text-sm text-slate-400 hover:bg-white/5 hover:text-white">
                        <i data-lucide="user" class="w-5 h-5"></i>
                        <span>Profile</span>
                    </button>
                    <button onclick="changeView('settings')" class="sidebar-item w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 font-bold text-sm text-slate-400 hover:bg-white/5 hover:text-white">
                        <i data-lucide="settings" class="w-5 h-5"></i>
                        <span>Settings</span>
                    </button>
                </nav>
            </aside>

            <!-- Main Content Area -->
            <main id="main-content" class="flex-1 overflow-y-auto hide-scrollbar pb-32 lg:pb-12 p-6 lg:p-12 relative">
                <!-- Header -->
                <header class="flex justify-between items-center mb-12 stagger-in">
                   <div>
                       <h2 id="page-title" class="text-3xl font-black tracking-tight">DASHBOARD</h2>
                       <p class="text-slate-500 text-[10px] font-black uppercase tracking-[0.2em] mt-1">Industry Control Hub</p>
                   </div>
                   <div class="flex items-center gap-6">
                      <button onclick="changeView('profile')" class="w-10 h-10 bg-purple-600 rounded-full border-2 border-purple-400/50 shadow-lg cursor-pointer hover:scale-110 transition-all"></button>
                   </div>
                </header>

                <!-- Dynamic Content Sections -->
                <div id="dashboard-view" class="space-y-10">
                    <!-- Stats Cards -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 stagger-in">
                        <div class="stat-card glass-panel border-l-purple-500">
                            <div class="stat-card-content">
                                <p class="stat-label">Market Value</p>
                                <p id="market-value" class="stat-value">Rp 0</p>
                                <p class="stat-subtext text-emerald-400">‚Üë Total Inventory Value</p>
                            </div>
                        </div>
                        <div class="stat-card glass-panel border-l-cyan-400">
                            <div class="stat-card-content">
                                <p class="stat-label">Active Matrix</p>
                                <p id="active-matrix" class="stat-value">0</p>
                                <p class="stat-subtext text-slate-500">Protocol Active</p>
                            </div>
                        </div>
                        <div class="stat-card glass-panel border-l-indigo-500 sm:col-span-2 lg:col-span-1">
                            <div class="stat-card-content">
                                <p class="stat-label">Optimization Score</p>
                                <p id="optimization-score" class="stat-value">0%</p>
                                <p class="stat-subtext text-emerald-400">‚Üë Confidence Level</p>
                            </div>
                        </div>
                    </div>

                    <!-- Register Asset Form -->
                    <div class="stagger-in p-8 lg:p-12 rounded-[3.5rem] glass-panel shadow-2xl relative overflow-hidden">
                        <div class="flex items-center gap-4 mb-10">
                           <div class="w-12 h-12 bg-purple-600 rounded-2xl flex items-center justify-center shadow-lg shadow-purple-600/20">
                               <i data-lucide="sparkles" class="w-6 h-6"></i>
                           </div>
                           <h2 class="text-3xl font-black tracking-tight">Register New Asset</h2>
                        </div>
                        
                        <form id="asset-form" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 relative z-10">
                            <!-- Image Upload -->
                            <div class="lg:col-span-1 flex flex-col items-center justify-center p-6 border-2 border-dashed border-white/10 rounded-3xl bg-black/20 hover:border-purple-500/50 transition-all cursor-pointer group" onclick="document.getElementById('image-upload').click()">
                                <input type="file" id="image-upload" class="hidden" accept="image/*" onchange="handleImageUpload(event)">
                                <div id="image-preview-container" class="flex flex-col items-center gap-4 py-8">
                                    <div class="w-16 h-16 bg-white/5 rounded-full flex items-center justify-center text-slate-400 group-hover:text-purple-400 transition-colors">
                                        <i data-lucide="camera" class="w-8 h-8"></i>
                                    </div>
                                    <p class="text-[10px] font-black uppercase tracking-widest text-slate-500">Product Photo</p>
                                </div>
                            </div>

                            <!-- Form Fields -->
                            <div class="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-8">
                                <div class="space-y-3">
                                    <label class="text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1">Asset Name</label>
                                    <input type="text" id="asset-name" placeholder="Nama Produk/Jasa" required class="w-full p-5 rounded-2xl font-bold">
                                </div>
                                <div class="space-y-3">
                                    <label class="text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1">Category</label>
                                    <select id="asset-category" class="w-full p-5 rounded-2xl font-bold">
                                        <option value="Kuliner">Kuliner & Minuman</option>
                                        <option value="Fashion">Fashion & Apparel</option>
                                        <option value="Kecantikan">Kecantikan & Skincare</option>
                                        <option value="Elektronik">Elektronik & Gadget</option>
                                        <option value="Rumah Tangga">Rumah Tangga</option>
                                        <option value="Agribisnis">Agribisnis & Pertanian</option>
                                        <option value="Edukasi">Edukasi & Kursus</option>
                                        <option value="Otomotif">Otomotif & Bengkel</option>
                                        <option value="Kesehatan">Kesehatan & Farmasi</option>
                                        <option value="Properti">Properti & Real Estate</option>
                                        <option value="Jasa">Jasa Profesional</option>
                                        <option value="Kerajinan">Kerajinan Tangan</option>
                                        <option value="Hobi">Hobi & Koleksi</option>
                                    </select>
                                </div>
                                <div class="space-y-3">
                                    <label class="text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1">Modal Per Unit</label>
                                    <input type="number" id="cost-price" placeholder="Harga Modal" required class="w-full p-5 rounded-2xl font-bold">
                                </div>
                                <div class="space-y-3">
                                    <label class="text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1">Harga Jual</label>
                                    <input type="number" id="sell-price" placeholder="Harga Jual" required class="w-full p-5 rounded-2xl font-bold">
                                </div>
                            </div>

                            <!-- Additional Options -->
                            <div class="space-y-3">
                                <label class="text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1">Budget</label>
                                <select id="budget" class="w-full p-5 rounded-2xl font-bold">
                                    <option value="0">Rp 0 (Organik)</option>
                                    <option value="< 1 Juta">&lt; 1 Juta</option>
                                    <option value="5jt">&gt; 5 Juta</option>
                                </select>
                            </div>
                            <div class="space-y-3">
                                <label class="text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1">Content Skill</label>
                                <select id="skill" class="w-full p-5 rounded-2xl font-bold">
                                    <option value="yes">Bisa Konten Kreatif</option>
                                    <option value="no">Pemula</option>
                                </select>
                            </div>
                            <div class="lg:col-span-1 flex items-end">
                                <button type="submit" class="btn-primary w-full py-5 rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl">Register Asset</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Inventory View (Hidden Initially) -->
                <div id="inventory-view" class="space-y-10 hidden">
                    <div id="inventory-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10 stagger-in">
                        <!-- Products will be dynamically added here -->
                    </div>
                </div>

                <!-- Strategy View (Hidden Initially) -->
                <div id="strategy-view" class="space-y-12 hidden">
                    <div id="loading-strategy" class="thinking-glow h-[60vh] flex flex-col items-center justify-center text-center bg-white/5 rounded-[4rem] p-12 hidden">
                        <div class="w-16 h-16 bg-purple-600 rounded-full animate-pulse mb-8 shadow-[0_0_40px_rgba(157,92,255,0.6)]"></div>
                        <h2 class="text-3xl font-black mb-4" id="sync-status">Syncing Data...</h2>
                        <p class="text-slate-500 font-bold uppercase tracking-[0.2em] text-xs">Optimizing Protocols</p>
                    </div>

                    <div id="strategy-content" class="hidden">
                        <!-- Strategy content will be dynamically added here -->
                    </div>
                </div>

                <!-- Profile View (Hidden Initially) -->
                <div id="profile-view" class="max-w-4xl mx-auto space-y-12 stagger-in text-center hidden">
                    <div class="glass-panel rounded-[4rem] p-8 md:p-16 relative overflow-hidden">
                        <div class="w-32 h-32 bg-purple-600 rounded-full mx-auto mb-10 border-4 border-purple-400 shadow-2xl flex items-center justify-center text-5xl">üè¢</div>
                        <h1 id="business-name" class="text-4xl md:text-5xl font-black mb-4 tracking-tighter">OptimaBiz Enterprise</h1>
                        <p id="business-tagline" class="text-purple-400 font-black uppercase tracking-widest text-xs mb-8">Scale Your Success with Precision</p>
                        <div class="max-w-xl mx-auto space-y-4">
                           <input id="edit-business-name" class="w-full p-5 rounded-2xl font-bold" value="OptimaBiz Enterprise">
                           <textarea id="edit-business-bio" class="w-full p-5 rounded-2xl font-medium h-32 resize-none">Sistem navigasi cerdas untuk optimasi pertumbuhan bisnis UMKM di segala sektor.</textarea>
                           <button onclick="saveProfile()" class="btn-primary px-8 py-4 rounded-2xl font-black uppercase text-xs tracking-widest">Save Profile</button>
                        </div>
                    </div>
                </div>

                <!-- Settings View (Hidden Initially) -->
                <div id="settings-view" class="max-w-4xl mx-auto stagger-in hidden">
                    <div class="glass-panel rounded-[3rem] p-8 md:p-12 space-y-10">
                       <h3 class="text-2xl font-black flex items-center gap-4">
                           <span>üåç</span> Configuration
                       </h3>
                       <div class="flex justify-between items-center">
                           <span class="text-sm font-black uppercase tracking-widest text-slate-300">Expo Mode</span>
                           <input type="checkbox" id="expo-mode" class="w-6 h-6 accent-purple-600 rounded-lg">
                       </div>
                       <button onclick="resetAllData()" class="w-full p-6 rounded-2xl bg-red-900/10 text-red-400 border border-red-900/20 font-black uppercase text-xs tracking-widest">Reset All Storage</button>
                    </div>
                </div>
            </main>

            <!-- Mobile Navigation -->
            <nav class="no-print lg:hidden fixed bottom-0 left-0 right-0 h-28 bg-[#14111D] border-t border-white/5 px-6 flex items-center justify-around z-50">
                <button onclick="changeView('dashboard')" class="mobile-nav-btn flex flex-col items-center gap-1 transition-all text-purple-400">
                    <i data-lucide="layout-dashboard" class="w-6 h-6"></i>
                    <span class="text-[8px] font-black uppercase">Home</span>
                </button>
                <button onclick="changeView('inventory')" class="mobile-nav-btn flex flex-col items-center gap-1 transition-all text-slate-500">
                    <i data-lucide="package" class="w-6 h-6"></i>
                    <span class="text-[8px] font-black uppercase">Vault</span>
                </button>
                <button onclick="scrollToForm()" class="w-16 h-16 bg-[#00E5FF] rounded-full flex items-center justify-center text-black font-black text-3xl shadow-[0_0_30px_rgba(0,229,255,0.4)] border-8 border-[#14111D] -translate-y-10 active:scale-90 transition-transform">+</button>
                <button onclick="changeView('strategy')" class="mobile-nav-btn flex flex-col items-center gap-1 transition-all text-slate-500">
                    <i data-lucide="trending-up" class="w-6 h-6"></i>
                    <span class="text-[8px] font-black uppercase">Plan</span>
                </button>
                <button onclick="changeView('settings')" class="mobile-nav-btn flex flex-col items-center gap-1 transition-all text-slate-500">
                    <i data-lucide="settings" class="w-6 h-6"></i>
                    <span class="text-[8px] font-black uppercase">Setup</span>
                </button>
            </nav>
        </div>
    </div>

    <script>
        // Initialize Lucide Icons
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
        });

        // Application State
        const appState = {
            products: JSON.parse(localStorage.getItem('ob_products')) || [],
            activePlan: JSON.parse(localStorage.getItem('ob_active_plan')) || null,
            profile: JSON.parse(localStorage.getItem('ob_profile')) || {
                name: 'OptimaBiz Enterprise',
                tagline: 'Scale Your Success with Precision',
                bio: 'Sistem navigasi cerdas untuk optimasi pertumbuhan bisnis UMKM di segala sektor.',
                socials: { instagram: '', tiktok: '', shopee: '' }
            },
            settings: JSON.parse(localStorage.getItem('ob_settings')) || {
                currency: 'Rp',
                defaultTarget: 'Nasional',
                expoMode: true,
                pdfIncludeCharts: true,
                reminders: true,
                language: 'id'
            },
            currentView: 'dashboard',
            formInputs: { budget: '< 1 Juta', skill: 'no', selectedPlatform: '' },
            imagePreview: null
        };

        // Save state to localStorage
        function saveState() {
            localStorage.setItem('ob_products', JSON.stringify(appState.products));
            localStorage.setItem('ob_active_plan', JSON.stringify(appState.activePlan));
            localStorage.setItem('ob_profile', JSON.stringify(appState.profile));
            localStorage.setItem('ob_settings', JSON.stringify(appState.settings));
            updateUI();
        }

        // Navigation Functions
        function openConsole() {
            document.getElementById('landing-page').style.display = 'none';
            document.getElementById('main-app').classList.remove('hidden');
            changeView('dashboard');
        }

        function changeView(view) {
            appState.currentView = view;
            
            // Update page title
            document.getElementById('page-title').textContent = view.toUpperCase();
            
            // Hide all views
            const views = ['dashboard', 'inventory', 'strategy', 'profile', 'settings'];
            views.forEach(v => {
                document.getElementById(`${v}-view`).classList.add('hidden');
            });
            
            // Show current view
            document.getElementById(`${view}-view`).classList.remove('hidden');
            
            // Update navigation active states
            updateNavigationActiveState(view);
            
            // Update UI based on view
            if (view === 'dashboard') {
                updateDashboardStats();
            } else if (view === 'inventory') {
                renderInventory();
            } else if (view === 'strategy') {
                renderStrategy();
            } else if (view === 'profile') {
                loadProfile();
            } else if (view === 'settings') {
                loadSettings();
            }
            
            // Show/hide demo actions
            const demoActions = document.getElementById('demo-actions');
            if (view === 'dashboard' && appState.settings.expoMode) {
                demoActions.classList.remove('hidden');
            } else {
                demoActions.classList.add('hidden');
            }
        }

        function updateNavigationActiveState(activeView) {
            // Desktop sidebar
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('sidebar-item-active', 'text-white');
                item.classList.add('text-slate-400');
            });
            
            // Mobile navigation
            document.querySelectorAll('.mobile-nav-btn').forEach(btn => {
                btn.classList.remove('text-purple-400');
                btn.classList.add('text-slate-500');
            });
            
            // Set active state for current view
            const desktopBtn = document.querySelector(`.sidebar-item:nth-child(${['dashboard','inventory','strategy','profile','settings'].indexOf(activeView) + 1})`);
            if (desktopBtn) {
                desktopBtn.classList.add('sidebar-item-active', 'text-white');
                desktopBtn.classList.remove('text-slate-400');
            }
            
            const mobileBtn = document.querySelectorAll('.mobile-nav-btn')[['dashboard','inventory','strategy','settings'].indexOf(activeView)];
            if (mobileBtn) {
                mobileBtn.classList.add('text-purple-400');
                mobileBtn.classList.remove('text-slate-500');
            }
        }

        function scrollToForm() {
            changeView('dashboard');
            setTimeout(() => {
                document.querySelector('form').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        // Form Handling
        document.getElementById('asset-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('asset-name').value;
            const category = document.getElementById('asset-category').value;
            const costPrice = parseFloat(document.getElementById('cost-price').value) || 0;
            const sellPrice = parseFloat(document.getElementById('sell-price').value) || 0;
            const margin = sellPrice > 0 ? Math.round(((sellPrice - costPrice) / sellPrice) * 100) : 0;
            
            const product = {
                id: Date.now().toString(),
                name,
                type: category,
                costPrice,
                sellPrice,
                margin,
                image: appState.imagePreview || undefined
            };
            
            appState.products.push(product);
            appState.formInputs.budget = document.getElementById('budget').value;
            appState.formInputs.skill = document.getElementById('skill').value;
            
            // Reset form
            document.getElementById('asset-form').reset();
            document.getElementById('image-preview-container').innerHTML = `
                <div class="w-16 h-16 bg-white/5 rounded-full flex items-center justify-center text-slate-400 group-hover:text-purple-400 transition-colors">
                    <i data-lucide="camera" class="w-8 h-8"></i>
                </div>
                <p class="text-[10px] font-black uppercase tracking-widest text-slate-500">Product Photo</p>
            `;
            appState.imagePreview = null;
            lucide.createIcons();
            
            saveState();
            changeView('inventory');
        });

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onloadend = function() {
                    appState.imagePreview = reader.result;
                    document.getElementById('image-preview-container').innerHTML = `
                        <div class="relative w-full h-48 rounded-2xl overflow-hidden">
                            <img src="${reader.result}" class="w-full h-full object-cover" alt="Preview">
                            <div class="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                <i data-lucide="refresh-cw" class="w-8 h-8 text-white"></i>
                            </div>
                        </div>
                    `;
                    lucide.createIcons();
                };
                reader.readAsDataURL(file);
            }
        }

        // Demo Data Functions
        function loadDemoData(scenario) {
            if (scenario === 'snack') {
                document.getElementById('asset-name').value = "Kripik Tempe Premium";
                document.getElementById('asset-category').value = "Kuliner";
                document.getElementById('sell-price').value = 15000;
                document.getElementById('cost-price').value = 7000;
                document.getElementById('budget').value = "0";
                document.getElementById('skill').value = "no";
                appState.imagePreview = "https://images.unsplash.com/photo-1621447509323-5705b5ff70a6?auto=format&fit=crop&q=80&w=800";
            } else if (scenario === 'agri') {
                document.getElementById('asset-name').value = "Pupuk Organik Cair 5L";
                document.getElementById('asset-category').value = "Agribisnis";
                document.getElementById('sell-price').value = 120000;
                document.getElementById('cost-price').value = 45000;
                document.getElementById('budget').value = "< 1 Juta";
                document.getElementById('skill').value = "no";
                appState.imagePreview = "https://images.unsplash.com/photo-1592919016327-5196f323be06?auto=format&fit=crop&q=80&w=800";
            } else {
                document.getElementById('asset-name').value = "Kursus Content Creator";
                document.getElementById('asset-category').value = "Edukasi";
                document.getElementById('sell-price').value = 2500000;
                document.getElementById('cost-price').value = 0;
                document.getElementById('budget').value = "5jt";
                document.getElementById('skill').value = "yes";
                appState.imagePreview = "https://images.unsplash.com/photo-1552664730-d307ca884978?auto=format&fit=crop&q=80&w=800";
            }
            
            // Update image preview
            if (appState.imagePreview) {
                document.getElementById('image-preview-container').innerHTML = `
                    <div class="relative w-full h-48 rounded-2xl overflow-hidden">
                        <img src="${appState.imagePreview}" class="w-full h-full object-cover" alt="Preview">
                        <div class="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                            <i data-lucide="refresh-cw" class="w-8 h-8 text-white"></i>
                        </div>
                    </div>
                `;
                lucide.createIcons();
            }
            
            // Animate demo indicator
            document.querySelectorAll('.demo-indicator').forEach(indicator => {
                indicator.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    indicator.style.transform = 'scale(1)';
                }, 300);
            });
        }

        // Business Logic Engine
        function calculateAIPlatform(product, skill) {
            const type = product.type;
            
            // High-Trust / Professional Industries
            if (type === 'Jasa' || type === 'Edukasi') {
                return product.sellPrice > 500000 ? 'LinkedIn' : 'Instagram';
            }
            
            // High-Local / Urgent / Essential Industries
            if (type === 'Kuliner' || type === 'Otomotif' || type === 'Kesehatan' || type === 'Rumah Tangga') {
                return 'WhatsApp';
            }
            
            // High-Visual / Trend Driven Industries
            if (type === 'Fashion' || type === 'Kecantikan' || type === 'Kerajinan' || type === 'Hobi') {
                return skill === 'yes' ? 'TikTok' : 'Instagram';
            }

            // Technical / Utility Industries
            if (type === 'Elektronik') {
                return 'Tokopedia';
            }

            // High-Capital / Community Based Industries
            if (type === 'Agribisnis' || type === 'Properti') {
                return 'Facebook';
            }
            
            return 'Shopee'; // Default
        }

        function generateActionPlan(product, platform, skill, budget) {
            const margin = product.margin;
            const type = product.type;
            
            let strategy = "";
            let setupTasks = [];
            let growthTasks = [];
            let scalingTasks = [];
            let setupTitle = "Minggu 1 (Setup): Pondasi Digital";

            // Customize based on Industry characteristic
            if (type === 'Agribisnis' || type === 'Properti') {
                setupTitle = "Bulan 1 (Setup): Supply Chain & Legalitas";
                setupTasks = ["Riset Suplier/Lahan & Legalitas", "Dokumentasi Proses (Harvest/Listing)", "Membangun Jaringan Broker/Agen"];
                growthTasks = ["Iklan Berbasis Wilayah (FB Ads)", "Edukasi Produk/Proyek", "Program Kunjungan/Open House"];
                scalingTasks = ["Ekspansi Distribusi Nasional", "Sistem Kemitraan Strategis", "Automasi Database Prospek"];
            } else if (type === 'Kuliner' || type === 'Kesehatan') {
                setupTasks = ["Standardisasi Menu/Produk", "Foto Produk Food-App Ready", "Optimasi Profil WhatsApp Business"];
                growthTasks = ["Program 'Review Jujur' Pelanggan", "Sistem Delivery Lokal Optimized", "Promosi via Story & Status"];
                scalingTasks = ["Sistem Franchise/Cabang", "Optimasi CRM (Data Pelanggan)", "Inovasi Varian Menu Berkala"];
            } else if (type === 'Jasa' || type === 'Edukasi') {
                setupTasks = ["Penyusunan Portfolio/Kurikulum", "Setting Jadwal & Booking System", "Personal Branding LinkedIn/IG"];
                growthTasks = ["Posting Testimoni & Case Study", "Webinar/Free Class Mini", "Iklan Retargeting Prospek"];
                scalingTasks = ["Sistem Kursus Mandiri/LMS", "Hire Tim Operasional", "Membership/Retainer Program"];
            } else {
                // Retail style: Fashion, Electronics, Crafts
                setupTasks = ["Riset Keyword SEO Marketplace", "Optimasi Katalog (Clean View)", "Setup Voucher & Promo Toko"];
                growthTasks = ["Influencer Seeding", "Live Streaming Jualan", "Ads Internal Marketplace"];
                scalingTasks = ["Ekspansi ke Warehouse Regional", "Sistem Affiliate Pelanggan", "Global Export via Marketplace"];
            }

            // General platform-based strategy enhancement
            if (platform === 'TikTok') {
                strategy = `Gunakan tren audio populer untuk menunjukkan ${type === 'Fashion' ? 'Outfit' : 'Kegunaan'} produk dalam 15 detik.`;
            } else if (platform === 'LinkedIn') {
                strategy = `Bangun otoritas sebagai pakar di bidang ${type}. Hubungkan manfaat produk dengan solusi profesional.`;
            } else {
                strategy = `Optimasi distribusi via ${platform} dengan fokus pada konversi chat dan rating tinggi.`;
            }

            // Success Score Logic
            let score = 70;
            if (skill === 'yes') score += 10;
            if (margin > 30) score += 5;
            if (budget === '5jt') score += 10;
            if (type === 'Agribisnis' && platform === 'Facebook') score += 3;

            return {
                productId: product.id,
                platform,
                strategy,
                phases: {
                    setup: { title: setupTitle, tasks: setupTasks },
                    growth: { title: "Bulan Berikutnya (Growth): Penetrasi", tasks: growthTasks },
                    scaling: { title: "Fase Lanjut (Scaling): Dominasi", tasks: scalingTasks }
                },
                successScore: Math.min(score, 99)
            };
        }

        // Strategy Processing
        async function processStrategy(product, customPlatform) {
            const loadingDiv = document.getElementById('loading-strategy');
            const strategyContent = document.getElementById('strategy-content');
            
            loadingDiv.classList.remove('hidden');
            strategyContent.classList.add('hidden');
            
            const statuses = ["Syncing Data...", "Analyzing Industry Dynamics...", "Processing Matrix...", "Finalizing Protocol..."];
            let i = 0;
            
            const statusInterval = setInterval(() => {
                document.getElementById('sync-status').textContent = statuses[i];
                i = (i + 1) % statuses.length;
            }, 600);

            try {
                // Simulate AI processing delay
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                const aiPlatform = calculateAIPlatform(product, appState.formInputs.skill);
                const finalPlatform = customPlatform || appState.formInputs.selectedPlatform || aiPlatform;
                const plan = generateActionPlan(product, finalPlatform, appState.formInputs.skill, appState.formInputs.budget);
                
                // Simulate AI enhanced strategy (in real app, this would call Gemini API)
                const aiEnhancedText = `Strategi terfokus untuk ${product.name} di platform ${finalPlatform}: ${plan.strategy} Optimalkan dengan konten yang menunjukkan nilai unik industri ${product.type}.`;
                
                appState.activePlan = { ...plan, strategy: aiEnhancedText, platform: finalPlatform };
                
            } catch (e) {
                const aiPlatform = calculateAIPlatform(product, appState.formInputs.skill);
                const plan = generateActionPlan(product, customPlatform || aiPlatform, appState.formInputs.skill, appState.formInputs.budget);
                appState.activePlan = plan;
            } finally {
                clearInterval(statusInterval);
                loadingDiv.classList.add('hidden');
                saveState();
                renderStrategy();
            }
        }

        // UI Rendering Functions
        function updateUI() {
            updateDashboardStats();
            if (appState.currentView === 'inventory') renderInventory();
            if (appState.currentView === 'strategy') renderStrategy();
        }

        function updateDashboardStats() {
            const totalValue = appState.products.reduce((sum, p) => sum + p.sellPrice, 0);
            document.getElementById('market-value').textContent = 
                `${appState.settings.currency} ${totalValue.toLocaleString()}`;
            document.getElementById('active-matrix').textContent = appState.activePlan ? '1' : '0';
            document.getElementById('optimization-score').textContent = 
                appState.activePlan ? `${appState.activePlan.successScore}%` : '0%';
        }

        function renderInventory() {
            const container = document.getElementById('inventory-grid');
            
            if (appState.products.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full py-40 text-center border-2 border-dashed border-white/5 rounded-[3.5rem] text-slate-600 font-bold italic">
                        No assets registered yet.
                    </div>
                `;
                return;
            }
            
            container.innerHTML = appState.products.map(product => {
                const isActive = appState.activePlan && appState.activePlan.productId === product.id;
                
                return `
                    <div class="rounded-[3rem] glass-panel overflow-hidden group hover:transform hover:-translate-y-3 transition-transform duration-300">
                        <div class="h-60 bg-white/5 relative overflow-hidden">
                            <img src="${product.image || 'https://images.unsplash.com/photo-1620916566398-39f1143ab7be?auto=format&fit=crop&q=80&w=800'}" 
                                 class="w-full h-full object-cover grayscale group-hover:grayscale-0 group-hover:scale-110 transition-all duration-700" 
                                 alt="${product.name}">
                            ${isActive ? `
                                <div class="absolute top-6 left-6 px-4 py-1.5 rounded-full bg-cyan-400 text-black text-[9px] font-black uppercase tracking-widest shadow-lg shadow-cyan-400/30">
                                    STRATEGY ACTIVE
                                </div>
                            ` : ''}
                            <div class="absolute bottom-4 left-4 px-3 py-1 bg-black/60 backdrop-blur-md rounded-full text-[8px] font-black uppercase tracking-widest border border-white/10">
                                ${product.type}
                            </div>
                        </div>
                        <div class="p-8 md:p-10">
                            <h3 class="text-xl md:text-2xl font-black mb-6 tracking-tight line-clamp-1">${product.name}</h3>
                            <div class="space-y-6">
                                <div class="flex justify-between items-center bg-black/40 p-4 rounded-xl border border-white/5">
                                    <div>
                                        <p class="text-[9px] font-black text-slate-500 uppercase">Jual</p>
                                        <p class="font-black text-lg">${appState.settings.currency} ${product.sellPrice.toLocaleString()}</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-[9px] font-black text-slate-500 uppercase">Margin</p>
                                        <p class="font-black text-lg text-emerald-400">+${product.margin}%</p>
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <button onclick="processStrategy(${JSON.stringify(product).replace(/"/g, '&quot;')})" 
                                            class="btn-primary py-4 rounded-xl font-black text-[10px] uppercase tracking-widest">
                                        Path 1: AI Rec
                                    </button>
                                    <select onchange="processStrategy(${JSON.stringify(product).replace(/"/g, '&quot;')}, this.value)"
                                            class="bg-black/40 border border-white/5 p-4 rounded-xl text-[10px] font-black uppercase">
                                        <option value="" disabled selected>Path 2: Manual</option>
                                        <option value="TikTok">TikTok</option>
                                        <option value="Instagram">Instagram</option>
                                        <option value="WhatsApp">WhatsApp</option>
                                        <option value="Shopee">Shopee</option>
                                        <option value="Tokopedia">Tokopedia</option>
                                        <option value="LinkedIn">LinkedIn</option>
                                        <option value="Facebook">Facebook</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderStrategy() {
            const container = document.getElementById('strategy-content');
            
            if (!appState.activePlan) {
                container.innerHTML = `
                    <div class="py-60 text-center">
                        <button onclick="changeView('inventory')" class="btn-primary px-10 py-5 rounded-2xl font-black uppercase text-xs">
                            Enter Asset Vault
                        </button>
                    </div>
                `;
                container.classList.remove('hidden');
                return;
            }
            
            const product = appState.products.find(p => p.id === appState.activePlan.productId);
            
            container.innerHTML = `
                <div class="space-y-12 pb-20">
                    <div id="strategy-header" class="p-8 md:p-12 rounded-[4rem] glass-panel border-l-[16px] border-l-purple-600 shadow-2xl relative overflow-hidden stagger-in">
                        <div class="flex justify-between items-start mb-8 md:mb-10">
                            <div class="inline-block px-5 py-2 rounded-full bg-purple-500/20 text-purple-400 text-[9px] font-black uppercase tracking-widest border border-purple-500/30">
                                MATRIX_INDUSTRY_SCAN
                            </div>
                            <div class="text-right">
                                <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest">Platform</p>
                                <p class="text-2xl font-black text-cyan-400">${appState.activePlan.platform}</p>
                            </div>
                        </div>
                        <h1 class="text-3xl md:text-5xl font-black mb-8 md:mb-10 tracking-tighter leading-none">
                            ${appState.profile.name} <br/>
                            <span class="text-purple-500">Plan Protocol</span>
                        </h1>
                        <div class="text-lg md:text-2xl text-slate-300 leading-relaxed font-semibold italic mb-8 md:mb-12 max-w-4xl" id="strategy-text">
                            ${appState.activePlan.strategy}
                        </div>
                        <div class="h-2 w-full bg-white/5 rounded-full overflow-hidden mb-5">
                            <div class="h-full bg-purple-600" style="width: ${appState.activePlan.successScore}%"></div>
                        </div>
                        <div class="flex justify-between text-[11px] font-black uppercase tracking-widest text-slate-500">
                            <span>Confidence Index</span>
                            <span class="text-purple-400">${appState.activePlan.successScore}% OPTIMIZED</span>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 stagger-in">
                        <div class="p-8 md:p-12 rounded-[3.5rem] glass-panel">
                            <h3 class="text-2xl font-black mb-8 md:mb-10 tracking-tight">Timeline Checklist</h3>
                            <div class="space-y-8 md:space-y-10">
                                ${Object.entries(appState.activePlan.phases).map(([key, phase]) => `
                                    <div class="relative pl-8 md:pl-10 border-l-2 border-white/5">
                                        <div class="absolute top-0 -left-[11px] w-5 h-5 bg-purple-600 rounded-full border-4 border-[#0B0813]"></div>
                                        <h4 class="text-xs font-black text-purple-400 uppercase tracking-widest mb-4">${phase.title}</h4>
                                        <div class="space-y-4">
                                            ${phase.tasks.map(task => `
                                                <div class="flex items-center gap-4 p-4 rounded-2xl bg-white/5 border border-white/5">
                                                    <div class="w-5 h-5 rounded-full border border-purple-500/50 flex items-center justify-center text-[10px] text-purple-500">‚úì</div>
                                                    <p class="font-bold text-sm text-slate-300">${task}</p>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="p-8 md:p-12 rounded-[3.5rem] glass-panel">
                            <h3 class="text-2xl font-black mb-8 md:mb-10 tracking-tight">Growth Projection</h3>
                            <div class="h-64 mb-8 md:mb-12">
                                <canvas id="growth-chart"></canvas>
                            </div>
                            <div class="p-6 md:p-8 rounded-3xl bg-cyan-400/5 border border-cyan-400/20 mb-8 md:mb-10">
                                <h4 class="text-xs font-black text-cyan-400 uppercase tracking-widest mb-2 flex items-center gap-2">
                                    <span>üõ°Ô∏è</span> Strategic Insight
                                </h4>
                                <p class="text-slate-400 text-sm leading-relaxed italic">
                                    Logika ini dioptimasi untuk kategori ${product?.type || 'industri'}. 
                                    Pantau respon pasar di minggu pertama fase growth.
                                </p>
                            </div>
                            <button onclick="window.print()" class="w-full btn-primary py-5 rounded-2xl font-black uppercase text-xs tracking-widest shadow-xl no-print">
                                Export Plan (PDF)
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            container.classList.remove('hidden');
            
            // Initialize chart
            setTimeout(() => {
                const ctx = document.getElementById('growth-chart').getContext('2d');
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                        datasets: [{
                            label: 'Growth Forecast',
                            data: [15, 30, 60, appState.activePlan.successScore],
                            borderColor: '#9D5CFF',
                            backgroundColor: 'rgba(157, 92, 255, 0.15)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3,
                            pointBackgroundColor: '#00E5FF',
                            pointRadius: 5
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { 
                                beginAtZero: true, 
                                max: 100, 
                                grid: { color: 'rgba(255,255,255,0.05)' }, 
                                ticks: { color: '#94A3B8' } 
                            },
                            x: { 
                                grid: { display: false }, 
                                ticks: { color: '#94A3B8' } 
                            }
                        }
                    }
                });
            }, 100);
        }

        function loadProfile() {
            document.getElementById('business-name').textContent = appState.profile.name;
            document.getElementById('business-tagline').textContent = appState.profile.tagline;
            document.getElementById('edit-business-name').value = appState.profile.name;
            document.getElementById('edit-business-bio').value = appState.profile.bio;
        }

        function saveProfile() {
            appState.profile.name = document.getElementById('edit-business-name').value;
            appState.profile.bio = document.getElementById('edit-business-bio').value;
            saveState();
            loadProfile();
        }

        function loadSettings() {
            document.getElementById('expo-mode').checked = appState.settings.expoMode;
        }

        function resetAllData() {
            if (confirm('Are you sure you want to reset all data? This action cannot be undone.')) {
                localStorage.clear();
                window.location.reload();
            }
        }

        // Initialize app
        updateUI();
        if (appState.settings.expoMode) {
            document.getElementById('demo-actions').classList.remove('hidden');
        }
    </script>
</body>

</html>
